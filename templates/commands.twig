{% extends "layout.twig" %}

{% block title %}Search endpoints{% endblock %}

{% block content %}
<div class="container feature">
    <h1 class="feature-title">Search endpoints</h1>
    <input type="text" class="typeahead tt-query" placeholder="e.g. GET users">
    <p class="feature-search-tip" hidden>Start typing the route youâ€™re looking for.</p>
    <p class="feature-or">or</p>
    <a href="/directory/" class="primary-button feature-button">Browse the directory</a>
</div>

<script type="text/template" id="template">
    <div class="typeahead-result" role="link">
        <h2 class="tt-suggestion-endpoint endpoint-<%= method %> endpoint-list-title">
            <span class="endpoint-list-method"><%= method %></span> <span class="endpoint-list-uri"><%= formattedUri %></span>
        </h2>
        <% if (summary) { %>
            <p class="tt-suggestion-summary endpoint-list-summary"><%= summary %></p>
        <% } %>
    </div>
</script>

<script type="text/javascript">
$(function() {
    localStorage.clear();

    $('.typeahead').one('focus', function () {
        var feature = $('.feature');
        $(feature).addClass('feature-active');

        setTimeout(function() {
            $(feature).find('.feature-or, .feature-button').attr('hidden', true);
            $(feature).find('.feature-search-tip').attr('hidden', false);
        }, 500);
    });

    template = _.template($('#template').html());

    $('.typeahead').typeahead({
        name: 'commands',
        prefetch: '/data/commands.json',
        template: template,
        limit: 16
    });

    $('.typeahead').on('typeahead:selected', function (event, datum) {
        window.location.href = datum.path;
    });
});
</script>
{% endblock %}
